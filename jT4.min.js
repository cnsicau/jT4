(function(w,$){if(!w.jT4){var g,u,p='push',l='length',f='function',h='prototype',LP,CP,TP,t;function B(a,b){this.type=a;this.text=b};B.T='Text';B.E='Expression';B.S='Statement';B.X='Extension';function L(){}LP=L[h];LP.regex=/\<\#([\+=]?)([\w\W]*?)\#\>/igm;LP.parse=function(_){var o=this.regex,m=o.exec(_),b=[],i=0,y,x;while(m){y=new B();y.text=m[2][r](/ +$/mg,'');if(i<m.index)b[p](new B(B.T,_.substr(i,m.index-i)));t=1;switch(m[1]){case"+":y.type=B.X;break;case"=":t=0;y.type=B.E;break;default:y.type=B.S;}if(t&&b[l]){x=b[b[l]-1];if(!(x.text=x.text[r](/^\s*$/,'')))b.pop();}b[p](y);i=m.index+m[0].length;m=o.exec(_)}if(i<_[l])b[p](new B(B.T,_.substr(i,_[l]-i)));return b;};function C(){}CP=C[h],r='replace';CP.e=function(_){return _&&_[r]?_[r](/\r/ig,'\\r')[r](/\n/ig,'\\n')[r](/"/ig,'\\"'):_};CP.i=0;CP.compile=function(_){var s=[],n,i;for(i=0;i<_[l];i++)if(_[i].type ==B.X)s[p](_[i].text);n='$'+(new Date().toString())[r](/\D/ig,'_')+'_'+this.i++;s[p]('var '+n+'="";');s[p](f+ ' write(s){'+n+'+= s}');s[p](f+' writeLine(s){'+n+'+=s+"\\r\\n"}');for(i=0;i<_[l];i++)if(_[i].type==B.E)s[p](n+'+='+_[i].text+';\n');else if(_[i].type==B.T)s[p](n+'+="'+this.e(_[i].text)+'";\n');else if(_[i].type==B.S)s[p](_[i].text+'\n');s[p]('return '+n+';');if(w.console&&console.log)console.log(f+'(){\nwith(this){\n'+s.join('\n')+'\n}\n}');return new Function('with(this){'+s.join('\n')+'}');};function T(){}TP=T[h];TP.lexer=new L();TP.compiler=new C();TP.$={};TP.compile=function(_){var t=this;var c=t.$[_];if(!c){var b=t.lexer.parse(_);c=t.$[_]=t.compiler.compile(b);}return function($){return c.call($);}};g=new T();w.jT4=function(_,c){_=g.compile(_);return c==u?_:_(c);};w.jT4.Engine=g;if($&&!$.jT4)$.fn.jT4=function(_){t=$(this);return w.jT4(t.is(':input')?t.val():t.html(),_)};}})(window,window.jQuery);
